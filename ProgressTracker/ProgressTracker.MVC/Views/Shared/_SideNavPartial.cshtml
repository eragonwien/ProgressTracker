@using System.Security.Claims
@using ProgressTracker.MVC.Models
@using Microsoft.AspNetCore.Mvc.Localization
@using SNGCommon.Resources
@inject IHtmlLocalizer<Translation> localizer
@inject ProgressTracker.MVC.Services.IProjectService projectService

@{
   var identity = Context.User.Identity as ClaimsIdentity;
   string username = identity?.Name;
   string email = identity?.FindFirst(ClaimTypes.Email)?.Value?.ToString();
   int.TryParse(identity?.FindFirst(ClaimTypes.NameIdentifier)?.Value, out int userId);
   bool authenticated = Context.User.Identity.IsAuthenticated;
   var projects = projectService.GetAll(userId).Where(p => p.Active && (p.Pttask.Any(t => t.Active && !t.Completed) || p.Pttask.Count == 0));
   string currentUrl = Context.Request.Path;
}
